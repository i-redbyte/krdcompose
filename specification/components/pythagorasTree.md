# PythagorasTree

## Общее описание

`PythagorasTree`— это Jetpack Compose `@Composable`, который отображает классическое **дерево
Пифагора** на `Canvas` и может плавно анимировать угол между ветвями. Компонент написан без
сторонних зависимостей и подходит как для демонстрационных, так и для образовательных приложений.

Фрактал строится рекурсивно: каждый квадрат порождает два дочерних квадрата, расположенных под углом
`angle` друг к другу. Размер потомков вычисляется через тригонометрические соотношения, что
гарантирует геометрическую точность фигуры.

##

![PythagorasTree](/specification/components/img/pythagorasTree.gif)

## Ключевые особенности

| Возможность                 | Описание                                                                                                 |
|-----------------------------|----------------------------------------------------------------------------------------------------------|
| **Анимация**                | Автоматическая анимация угла в пределах заданного диапазона. Запускается и останавливается по нажатию.   |
| **Параметризуемая глубина** | Число уровней рекурсии регулируется параметром `levels`.                                                 |
| **Настраиваемая палитра**   | Вы можете передать список цветов `colors`; они будут циклически применяться от корня к листьям.          |
| **Центрирование**           | Флаг `centerVertically` позволяет расположить дерево по центру экрана либо «прижать» его к нижнему краю. |
| **Произвольный разворот**   | Начальный угол всего дерева задаётся аргументом `rootRotation`.                                          |

## Параметры функции

| Параметр           | Тип                               | Значение по умолчанию       | Назначение                                                      |
|--------------------|-----------------------------------|-----------------------------|-----------------------------------------------------------------|
| `modifier`         | `Modifier`                        | `Modifier`                  | Позволяет задавать размеры и поведение внешнего контейнера.     |
| `levels`           | `Int`                             | `9`                         | Количество рекурсивных уровней (глубина фрактала).              |
| `colors`           | `List<Color>`                     | `listOf(Color(0xFF4CAF50))` | Палитра квадратов.                                              |
| `startAngle`       | `Float`                           | `45f`                       | Начальный угол между ветвями при первой отрисовке.              |
| `angleRange`       | `ClosedFloatingPointRange<Float>` | `10f..60f`                  | Диапазон колебаний угла при анимации.                           |
| `durationMillis`   | `Int`                             | `3000`                      | Длительность анимации одного полного прохода (в миллисекундах). |
| `centerVertically` | `Boolean`                         | `true`                      | Центрировать ли дерево по вертикали.                            |
| `rootRotation`     | `Float`                           | `0f`                        | Поворачивает всё дерево вокруг корня.                           |

## Пример использования

```kotlin
@Composable
fun DemoScreen() {
    Box(modifier = Modifier.fillMaxSize().background(Color.Black)) {
        PythagorasTree(
            levels = 11,
            colors = listOf(
                Color(0xFFB2FF59),
                Color(0xFF76FF03),
                Color(0xFF388E3C)
            ),
            angleRange = 15f..75f,
            durationMillis = 4000,
            rootRotation = -15f
        )
    }
}
```

Однократное нажатие на экран запускает анимацию; повторное — ставит её на паузу и возвращает дерево
к исходному углу `startAngle`.

## Детали реализации

1. **Анимация угла**  
   Используется `Animatable<Float>` и цикл `while (running)` внутри `LaunchedEffect` (здесь через
   `rememberCoroutineScope {}`), который плавно интерполирует значение угла между границами
   `angleRange`.

2. **Рекурсивная функция `drawTree`**
    * Вычисляет базисные векторы **v** (вдоль текущего направления) и **w** (вектор, повёрнутый на
      90°), чтобы получить координаты квадрата.
    * После отрисовки текущего квадрата функция рассчитывает размеры и позиции двух дочерних
      квадратов и вызывает себя с уровнем`level - 1`.

3. **Производительность**
    * Все вычисления выполняются в `DrawScope`, а значит, не блокируют компоновку.
    * Глубина рекурсии ограничена; при `levels > 13` возможна деградация FPS на слабых устройствах.
    * Для оптимизации можно кэшировать результаты `Path` на каждом уровне, если анимация не
      используется.

## Советы по кастомизации

- Чтобы получить эффект «растущего» дерева, анимируйте не угол, а длину начального квадрата, изменяя
  коэффициент `side`.
- Попробуйте менять `palette` в зависимости от времени года или системной темы (Day/Night).
- Для интерактивного обучения добавьте слайдер, который связывает значение `angle` с
  пользовательским вводом.

## Ограничения

- Компонент предназначен для экранов, где доступно достаточное количество пикселей; на очень
  маленьких дисплеях нижние уровни могут сливаться.

---

> **PR‑ы приветствуются!** Исправили баг, ускорили алгоритм, добавили блестяшку — кидайте :)


